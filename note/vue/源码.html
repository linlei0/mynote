<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>vue2源码 | linlei space</title>
    <meta name="generator" content="VuePress 1.5.2">
    
    <meta name="description" content="努力向前">
    <link rel="preload" href="/note/assets/css/0.styles.076a1fce.css" as="style"><link rel="preload" href="/note/assets/js/app.fb566414.js" as="script"><link rel="preload" href="/note/assets/js/2.ef60ecc2.js" as="script"><link rel="preload" href="/note/assets/js/58.ca2d3c5a.js" as="script"><link rel="prefetch" href="/note/assets/js/10.63164344.js"><link rel="prefetch" href="/note/assets/js/11.dfa5d71a.js"><link rel="prefetch" href="/note/assets/js/12.d3460194.js"><link rel="prefetch" href="/note/assets/js/13.a6daa81b.js"><link rel="prefetch" href="/note/assets/js/14.b4966971.js"><link rel="prefetch" href="/note/assets/js/15.bd48b85b.js"><link rel="prefetch" href="/note/assets/js/16.d0593544.js"><link rel="prefetch" href="/note/assets/js/17.7d66d147.js"><link rel="prefetch" href="/note/assets/js/18.bcc94a00.js"><link rel="prefetch" href="/note/assets/js/19.341a2f58.js"><link rel="prefetch" href="/note/assets/js/20.d72e90d7.js"><link rel="prefetch" href="/note/assets/js/21.bf4ca648.js"><link rel="prefetch" href="/note/assets/js/22.c832f64e.js"><link rel="prefetch" href="/note/assets/js/23.cb1b627f.js"><link rel="prefetch" href="/note/assets/js/24.d0d2cbcd.js"><link rel="prefetch" href="/note/assets/js/25.004605d1.js"><link rel="prefetch" href="/note/assets/js/26.19027660.js"><link rel="prefetch" href="/note/assets/js/27.182b9494.js"><link rel="prefetch" href="/note/assets/js/28.90eb73fd.js"><link rel="prefetch" href="/note/assets/js/29.98cd479a.js"><link rel="prefetch" href="/note/assets/js/3.2a7ffc07.js"><link rel="prefetch" href="/note/assets/js/30.960718b6.js"><link rel="prefetch" href="/note/assets/js/31.fef043f7.js"><link rel="prefetch" href="/note/assets/js/32.7f825317.js"><link rel="prefetch" href="/note/assets/js/33.2552d171.js"><link rel="prefetch" href="/note/assets/js/34.7b927da8.js"><link rel="prefetch" href="/note/assets/js/35.5f7d9833.js"><link rel="prefetch" href="/note/assets/js/36.cbbb8107.js"><link rel="prefetch" href="/note/assets/js/37.564ba86c.js"><link rel="prefetch" href="/note/assets/js/38.cf2106a8.js"><link rel="prefetch" href="/note/assets/js/39.bddd4924.js"><link rel="prefetch" href="/note/assets/js/4.724462bb.js"><link rel="prefetch" href="/note/assets/js/40.419a37fc.js"><link rel="prefetch" href="/note/assets/js/41.c6384eba.js"><link rel="prefetch" href="/note/assets/js/42.71d72732.js"><link rel="prefetch" href="/note/assets/js/43.e3295712.js"><link rel="prefetch" href="/note/assets/js/44.6ba20ae4.js"><link rel="prefetch" href="/note/assets/js/45.47c29c68.js"><link rel="prefetch" href="/note/assets/js/46.29754f6c.js"><link rel="prefetch" href="/note/assets/js/47.c655602a.js"><link rel="prefetch" href="/note/assets/js/48.b87a5f3b.js"><link rel="prefetch" href="/note/assets/js/49.e0c9e867.js"><link rel="prefetch" href="/note/assets/js/5.9968e306.js"><link rel="prefetch" href="/note/assets/js/50.219d3d3f.js"><link rel="prefetch" href="/note/assets/js/51.e6d26b0e.js"><link rel="prefetch" href="/note/assets/js/52.825068c4.js"><link rel="prefetch" href="/note/assets/js/53.e858d294.js"><link rel="prefetch" href="/note/assets/js/54.c3cdeae3.js"><link rel="prefetch" href="/note/assets/js/55.d9cadf6d.js"><link rel="prefetch" href="/note/assets/js/56.2cc543c0.js"><link rel="prefetch" href="/note/assets/js/57.ca3203e9.js"><link rel="prefetch" href="/note/assets/js/59.076b3889.js"><link rel="prefetch" href="/note/assets/js/6.fca4cc7f.js"><link rel="prefetch" href="/note/assets/js/7.fbd79dc9.js"><link rel="prefetch" href="/note/assets/js/8.5145ac11.js"><link rel="prefetch" href="/note/assets/js/9.0b992231.js">
    <link rel="stylesheet" href="/note/assets/css/0.styles.076a1fce.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/note/" class="home-link router-link-active"><!----> <span class="site-name">linlei space</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/note/note/" class="nav-link router-link-active">
  博客
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="算法" class="dropdown-title"><span class="title">算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/" class="nav-link">
  每日
</a></li><li class="dropdown-item"><!----> <a href="/note/" class="nav-link">
  LeetCode
</a></li></ul></div></div> <a href="https://github.com//" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/note/note/" class="nav-link router-link-active">
  博客
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="算法" class="dropdown-title"><span class="title">算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/" class="nav-link">
  每日
</a></li><li class="dropdown-item"><!----> <a href="/note/" class="nav-link">
  LeetCode
</a></li></ul></div></div> <a href="https://github.com//" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>性能优化</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>TypeScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Node</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>HTTP</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Linux</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>OS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Python</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Java</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Nginx</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>项目工程化</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据库</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>常用工具</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>自动化</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>js相关</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>QA相关</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>webpack</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>vue</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/note/note/vue/源码.html" class="active sidebar-link">vue2源码</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/note/vue/源码.html#在学习之前先了解什么是运行时，编译时" class="sidebar-link">在学习之前先了解什么是运行时，编译时</a></li><li class="sidebar-sub-header"><a href="/note/note/vue/源码.html#目录" class="sidebar-link">目录</a></li><li class="sidebar-sub-header"><a href="/note/note/vue/源码.html#domdiff" class="sidebar-link">domdiff</a></li></ul></li><li><a href="/note/note/vue/nuxt.html" class="sidebar-link">nuxt初探</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vue2源码"><a href="#vue2源码" class="header-anchor">#</a> vue2源码</h1> <h2 id="在学习之前先了解什么是运行时，编译时"><a href="#在学习之前先了解什么是运行时，编译时" class="header-anchor">#</a> 在学习之前先了解什么是运行时，编译时</h2> <p><strong>runtime(运行时)：当前程序运行过程中，保存的状态和数据</strong>
举个简单的例子,当我们实例化Vue的时候就创建了一个内存对象,我们可以通过mounted来改变data中的数据</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>    <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        data<span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span>a<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">2</span>
        <span class="token punctuation">}</span>
        <span class="token operator">...</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>runtime+compiler(编译时)：也和运行时一样，只不过多了一个解析vue模板的过程</strong>
compiler：在线编译模板
如下所示是一个简单的模板解析后的js代码</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token operator">&lt;</span>p<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> name <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token keyword">with</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">_c</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span><span class="token punctuation">[</span>
        <span class="token function">_c</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">,</span><span class="token punctuation">[</span>
            <span class="token function">_v</span><span class="token punctuation">(</span><span class="token function">_s</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="目录"><a href="#目录" class="header-anchor">#</a> 目录</h2> <ul><li><p><strong>1./compiler目录编译模板</strong></p> <p>作用：将.vue--&gt;打包编译 (词法分析，语法分析，构建AST,转义js) --&gt;输出 render()
然后使用正则匹配词法模板，缺点是效率很慢</p></li> <li><p>2.core目录是vue.js的核心
/component --&gt;keep-alive
global-api 全局api .use .mixin .extend
instance 生命周期，时间绑定处理
observer 双向数据绑定的逻辑</p> <p>utils 常用工具集
vdom 虚拟dom snabbdom</p></li> <li><p>3./entries 生产打包的入口</p></li> <li><p>4./platform 针对核心模块的平台模块</p></li> <li><p>5.platform 目录下在那时只有web目录(在最新的开发目录中已经有weex目录)。web目录下对应的/compiler，/runtime，
/server，/util目录</p></li> <li><ol start="6"><li>/server目录是处理服务端渲染</li></ol></li> <li><ol start="7"><li>/sfc目录处理单文件 .vue
8 /shared 目录提供全局用到的工具函数</li></ol></li></ul> <h1 id="整体架构"><a href="#整体架构" class="header-anchor">#</a> 整体架构</h1> <h1 id="vue的整体流程"><a href="#vue的整体流程" class="header-anchor">#</a> vue的整体流程</h1> <h1 id="vue运行时的优化"><a href="#vue运行时的优化" class="header-anchor">#</a> vue运行时的优化</h1> <p>双向数据绑定
Object.defineProperty
不能监听新增的key
get： 数据获取渲染视图</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>b<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
    <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'get val'</span><span class="token punctuation">,</span>key<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">newVal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'set val'</span><span class="token punctuation">,</span>key<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>数组的变更会导致频繁的移动位置,如下所示</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">observer</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">defineReactive</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span>key<span class="token punctuation">,</span>data<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">defineReactive</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span>key<span class="token punctuation">,</span>value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span>key<span class="token punctuation">,</span><span class="token punctuation">{</span>
    <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'get val'</span><span class="token punctuation">,</span>value<span class="token punctuation">)</span>
        <span class="token keyword">return</span> value
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">newVal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'set val'</span><span class="token punctuation">,</span>newVal<span class="token punctuation">)</span>
        newVal <span class="token operator">=</span> value
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span>  arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span>
<span class="token function">observer</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span>
arr<span class="token punctuation">.</span><span class="token function">unshift</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>如果触发了数据的修改和数据的获取，都可以监听到
先触发observer</p> <p>Observer</p> <p>watcher(衔接数据和指令的过程)
(一个指令对应一个watcher，实际是一个模板对应一个watcher)</p> <p><img src="/vue/%E5%8F%8C%E5%90%91%E7%BB%91%E5%AE%9A.png?200*300" alt="result1">
流程说明：当我们代码中写入基本的vue肯定会有data，模板dom<br>
此时模板会生成一个指令也就是Directive，会对应一个watcher，
而data则会实现数据得监听也就是Observer，当watcher中使用data中的数据时会去找到Observer中的get，
同时会将watcher添加到dep中留存，当data中的数据变更时则触发Observer中的set，在dep中找到留存的watcher，watcher通知指令
更新视图</p> <h2 id="domdiff"><a href="#domdiff" class="header-anchor">#</a> domdiff</h2> <ul><li>1.虚拟dom是什么?</li></ul> <p>主要就是一个对象，来描述dom节点，jsx react 也就是createElement方法在vue的h方法</p> <p>如下： 我们有了我们的h方法并传其type，props，...children</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;wrapper&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>span id<span class="token operator">=</span><span class="token string">&quot;text&quot;</span> style<span class="token operator">=</span><span class="token string">&quot;color: red&quot;</span><span class="token operator">&gt;</span>hello<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
    <span class="token string">&quot;zf&quot;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span> 
  <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>id<span class="token operator">:</span> <span class="token string">'wrapper'</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'span'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>id<span class="token operator">:</span> <span class="token string">'text'</span><span class="token punctuation">,</span>style<span class="token operator">:</span> <span class="token punctuation">{</span>color<span class="token operator">:</span> <span class="token string">'red'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'hello'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'zf'</span><span class="token punctuation">)</span>

 <span class="token keyword">const</span> domObj <span class="token operator">=</span> <span class="token punctuation">{</span>
     type<span class="token operator">:</span> <span class="token string">'div'</span><span class="token punctuation">,</span>
     props<span class="token operator">:</span> <span class="token punctuation">{</span>
        id<span class="token operator">:</span> <span class="token string">'wrapper'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    children<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            type<span class="token operator">:</span> <span class="token string">'span'</span><span class="token punctuation">,</span> props<span class="token operator">:</span> <span class="token punctuation">{</span>id<span class="token operator">:</span> <span class="token string">'text'</span><span class="token punctuation">,</span> style<span class="token operator">:</span> <span class="token punctuation">{</span>color<span class="token operator">:</span> <span class="token string">'red'</span><span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> 
        children<span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                type<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>props<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
                children<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>text<span class="token operator">:</span> <span class="token string">'hello'</span><span class="token punctuation">}</span>
                <span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>props<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span> children<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> text<span class="token operator">:</span> <span class="token string">'zf'</span> <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
 <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><ul><li>2.如何创建虚拟dom？
<em><strong>本例所有代码均基于webapck，请自行搭建webapck环境</strong></em>
代码如下，我们在src下创建vdom文件夹，然后创建h.js(暴露出h方法)和vndoe.js(返回虚拟节点对象)
<strong>h.js</strong></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code> <span class="token keyword">import</span> <span class="token punctuation">{</span> vnode <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./vnode'</span>
 <span class="token comment">/**
  * 
  * @param {*} type 类型
  * @param {*} props 属性
  * @param  {...any} children 子节点
  */</span>

 <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">createElement</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span>props<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token operator">...</span>children</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> key
    <span class="token keyword">if</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        key <span class="token operator">=</span> props<span class="token punctuation">.</span>key
        <span class="token keyword">delete</span> props<span class="token punctuation">.</span>key
    <span class="token punctuation">}</span>
    <span class="token comment">// 处理所有的子节点，如果子节点是string则表明是dom节点的文字了需要转换成虚拟节点，</span>
    children <span class="token operator">=</span> children<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">child</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> child <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token function">vnode</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span><span class="token keyword">undefined</span><span class="token punctuation">,</span>child<span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> child
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token function">vnode</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span>props<span class="token punctuation">,</span>key<span class="token punctuation">,</span>children<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p><strong>vnode.js</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/**
 * 
 * @param {*} type 
 * @param {*} props 
 * @param {*} key 
 * @param {*} children 
 * @param {*} text 
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">vnode</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span>props<span class="token punctuation">,</span>key<span class="token punctuation">,</span>children<span class="token punctuation">,</span>text</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        type<span class="token punctuation">,</span>
        props<span class="token punctuation">,</span>
        key<span class="token punctuation">,</span>
        children<span class="token punctuation">,</span>
        text
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>以上方法实现之后在vdom下创建index.js文件
<strong>vdom/index.js</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> h <span class="token keyword">from</span> <span class="token string">'./h'</span>
<span class="token comment">// import { render } from './patch'</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span>
    h<span class="token punctuation">,</span>
    <span class="token comment">// render</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>使用
<strong>src/index.js</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> h <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./vdom'</span>
<span class="token keyword">const</span> vnode <span class="token operator">=</span> <span class="token function">h</span><span class="token punctuation">(</span>
    <span class="token string">'div'</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>id<span class="token operator">:</span> <span class="token string">'wrapper'</span><span class="token punctuation">,</span> style<span class="token operator">:</span> <span class="token punctuation">{</span>color<span class="token operator">:</span> <span class="token string">'red'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">h</span><span class="token punctuation">(</span>
        <span class="token string">'span'</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>id<span class="token operator">:</span> <span class="token string">'text'</span><span class="token punctuation">,</span>style<span class="token operator">:</span> <span class="token punctuation">{</span>color<span class="token operator">:</span> <span class="token string">'red'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'hello'</span><span class="token punctuation">,</span>
        <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'i'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>id<span class="token operator">:</span> <span class="token string">'iiii'</span><span class="token punctuation">,</span>style<span class="token operator">:</span> <span class="token punctuation">{</span>color<span class="token operator">:</span> <span class="token string">'green'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'我是i标签'</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">'zf'</span>
<span class="token punctuation">)</span>
<span class="token comment">// const app = document.getElementById('app')</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>vnode<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>打印结果如下：</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;div&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;props&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;wrapper&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;style&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token property">&quot;color&quot;</span><span class="token operator">:</span><span class="token string">&quot;red&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;children&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;span&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;props&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
                <span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;style&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
                    <span class="token property">&quot;color&quot;</span><span class="token operator">:</span><span class="token string">&quot;red&quot;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token property">&quot;children&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>
                <span class="token punctuation">{</span>
                    <span class="token property">&quot;text&quot;</span><span class="token operator">:</span><span class="token string">&quot;hello&quot;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">{</span>
                    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;i&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;props&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
                        <span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;iiii&quot;</span><span class="token punctuation">,</span>
                        <span class="token property">&quot;style&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
                            <span class="token property">&quot;color&quot;</span><span class="token operator">:</span><span class="token string">&quot;green&quot;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;children&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>
                        <span class="token punctuation">{</span>
                            <span class="token property">&quot;text&quot;</span><span class="token operator">:</span><span class="token string">&quot;我是i标签&quot;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">]</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;text&quot;</span><span class="token operator">:</span><span class="token string">&quot;zf&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><p>说明：通过打印结果我们可以发现所谓的虚拟dom其实就一个对象，这个对象上type，props，children属性，
核心方法createElement也就是h方法会把我们的每一个最终会转换成vnode对象，这个对象就是我们所需要的虚拟对象了。</p> <p>-3.虚拟dom如何渲染成真实dom？
我们先创建patch.js</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/**
* 
* @param {*} vnode 用户虚拟节点
* @param {*} container 渲染到那个节点上
*/</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">vnode<span class="token punctuation">,</span>container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">// console.log(vnode,container)</span>
   <span class="token keyword">const</span> ele <span class="token operator">=</span> <span class="token function">createDomElementFrom</span><span class="token punctuation">(</span>vnode<span class="token punctuation">)</span>
   container<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>ele<span class="token punctuation">)</span>

<span class="token punctuation">}</span>
<span class="token comment">//通过虚拟丶对象创建真实的dom</span>
<span class="token keyword">function</span> <span class="token function">createDomElementFrom</span><span class="token punctuation">(</span><span class="token parameter">vnode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">let</span> <span class="token punctuation">{</span>type<span class="token punctuation">,</span>key<span class="token punctuation">,</span>props<span class="token punctuation">,</span>children<span class="token punctuation">,</span>text<span class="token punctuation">}</span> <span class="token operator">=</span> vnode
   <span class="token comment">// 表明传递的是一个标签，否则是一个文本</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       vnode<span class="token punctuation">.</span>domElement <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span> 
       <span class="token function">updateProperties</span><span class="token punctuation">(</span>vnode<span class="token punctuation">)</span>
       <span class="token comment">// 递归渲染子的虚拟节点</span>
       children<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">childrenVnode</span><span class="token operator">=&gt;</span><span class="token function">render</span><span class="token punctuation">(</span>childrenVnode<span class="token punctuation">,</span>vnode<span class="token punctuation">.</span>domElement<span class="token punctuation">)</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
       vnode<span class="token punctuation">.</span>domElement <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createTextNode</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span> 
   <span class="token punctuation">}</span>
   <span class="token keyword">return</span> vnode<span class="token punctuation">.</span>domElement
<span class="token punctuation">}</span>
<span class="token comment">// 后续比对的时候，会根据老的属性和新的属性重新更新节点</span>
<span class="token keyword">function</span> <span class="token function">updateProperties</span><span class="token punctuation">(</span><span class="token parameter">newVnode<span class="token punctuation">,</span>oldProps <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">let</span> domElement <span class="token operator">=</span> newVnode<span class="token punctuation">.</span>domElement <span class="token comment">// 真实的dom</span>
   <span class="token keyword">let</span> newProps <span class="token operator">=</span> newVnode<span class="token punctuation">.</span>props <span class="token comment">// 当前虚拟节点中的属性</span>

   <span class="token comment">// 如果老的节点有，新的节点没有，说明被移除了</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> oldPropsName <span class="token keyword">in</span> oldProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>newProps<span class="token punctuation">[</span>oldPropsName<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
           <span class="token keyword">delete</span> domElement<span class="token punctuation">[</span>oldPropsName<span class="token punctuation">]</span><span class="token punctuation">;</span>
       <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   <span class="token comment">//  如果新的里面有style，老的里面也有style，style可能不一样</span>
   <span class="token keyword">const</span> newStyleObj <span class="token operator">=</span> newProps<span class="token punctuation">.</span>style <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
   <span class="token keyword">const</span> oldStyleObj <span class="token operator">=</span> oldProps<span class="token punctuation">.</span>style <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> s <span class="token keyword">in</span> oldStyleObj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>newStyleObj<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
           domElement<span class="token punctuation">.</span>style<span class="token punctuation">[</span>s<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">''</span>
       <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   <span class="token comment">// 如果老的节点没有，新节点有，说明是新增</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> newPropsName <span class="token keyword">in</span> newProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">if</span><span class="token punctuation">(</span>newPropsName<span class="token operator">===</span><span class="token string">'style'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
           <span class="token keyword">const</span> styleObj <span class="token operator">=</span> newProps<span class="token punctuation">[</span>newPropsName<span class="token punctuation">]</span>
           <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> styleObj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
               domElement<span class="token punctuation">.</span>style<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> styleObj<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
           <span class="token punctuation">}</span>
       <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
           domElement<span class="token punctuation">[</span>newPropsName<span class="token punctuation">]</span> <span class="token operator">=</span> newProps<span class="token punctuation">[</span>newPropsName<span class="token punctuation">]</span>
       <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br></div></div><p>使用</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> h<span class="token punctuation">,</span> render <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./vdom'</span>
<span class="token keyword">const</span> vnode <span class="token operator">=</span> <span class="token function">h</span><span class="token punctuation">(</span>
   <span class="token string">'div'</span><span class="token punctuation">,</span>
   <span class="token punctuation">{</span>id<span class="token operator">:</span> <span class="token string">'wrapper'</span><span class="token punctuation">,</span> style<span class="token operator">:</span> <span class="token punctuation">{</span>color<span class="token operator">:</span> <span class="token string">'red'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
   <span class="token function">h</span><span class="token punctuation">(</span>
       <span class="token string">'span'</span><span class="token punctuation">,</span>
       <span class="token punctuation">{</span>id<span class="token operator">:</span> <span class="token string">'text'</span><span class="token punctuation">,</span>style<span class="token operator">:</span> <span class="token punctuation">{</span>color<span class="token operator">:</span> <span class="token string">'red'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'hello'</span><span class="token punctuation">,</span>
       <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'i'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>id<span class="token operator">:</span> <span class="token string">'iiii'</span><span class="token punctuation">,</span>style<span class="token operator">:</span> <span class="token punctuation">{</span>color<span class="token operator">:</span> <span class="token string">'green'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'我是i标签'</span><span class="token punctuation">)</span>
       <span class="token punctuation">)</span><span class="token punctuation">,</span>
   <span class="token string">'zf'</span>
<span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'app'</span><span class="token punctuation">)</span>
<span class="token function">render</span><span class="token punctuation">(</span>vnode<span class="token punctuation">,</span>app<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>说明：createDomElementFrom方法用来创建真实的dom最后挂载在app上，首先我们需要判断type属性如果存在则表明是一个标签那么就是用
document.createElement，如果不存在则说明是文本document.createTextNode，然后使用递归创建全部的节点**children.forEach(childrenVnode=&gt;render(childrenVnode,vnode.domElement))**此时我们的dom就全部创建完成了，然后我们需要添加他的属性，这个时候我们就要考虑到新属性和旧属性的问题了，如果老的节点有，新的节点没有，说明被移除了，如果老的节点没有，新节点有，说明是新增，以及style的问题如果新的里面有style，老的里面也有style，style可能不一样，到这里我们的真实dom就创建完成了。</p> <ul><li>4.虚拟dom如何patch？
1.类型不同,如下src/index.js我们创建一个newVode虚拟dom，并创建patch.js此时我们只需要将dom更换即可</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// src/index.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> h<span class="token punctuation">,</span> render<span class="token punctuation">,</span> patch<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./vdom'</span>
<span class="token keyword">const</span> oldVnode <span class="token operator">=</span> <span class="token function">h</span><span class="token punctuation">(</span>
    <span class="token string">'div'</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>id<span class="token operator">:</span> <span class="token string">'wrapper'</span><span class="token punctuation">,</span> style<span class="token operator">:</span> <span class="token punctuation">{</span>color<span class="token operator">:</span> <span class="token string">'red'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">h</span><span class="token punctuation">(</span>
        <span class="token string">'span'</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>id<span class="token operator">:</span> <span class="token string">'text'</span><span class="token punctuation">,</span>style<span class="token operator">:</span> <span class="token punctuation">{</span>color<span class="token operator">:</span> <span class="token string">'red'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'hello'</span><span class="token punctuation">,</span>
        <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'i'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>id<span class="token operator">:</span> <span class="token string">'iiii'</span><span class="token punctuation">,</span>style<span class="token operator">:</span> <span class="token punctuation">{</span>color<span class="token operator">:</span> <span class="token string">'green'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'我是i标签'</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">'zf'</span>
<span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'app'</span><span class="token punctuation">)</span>
<span class="token function">render</span><span class="token punctuation">(</span>oldVnode<span class="token punctuation">,</span>app<span class="token punctuation">)</span>
a
<span class="token keyword">const</span> newVode <span class="token operator">=</span> <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>id<span class="token operator">:</span> <span class="token string">'a'</span><span class="token punctuation">,</span> style<span class="token operator">:</span> <span class="token punctuation">{</span>color<span class="token operator">:</span> <span class="token string">'blue'</span><span class="token punctuation">,</span><span class="token string">'font-size'</span><span class="token operator">:</span> <span class="token string">'20px'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'更新的dom'</span><span class="token punctuation">)</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">patch</span><span class="token punctuation">(</span>oldVnode<span class="token punctuation">,</span> newVode<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// vdom/patch.js</span>
<span class="token operator">...</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">patch</span><span class="token punctuation">(</span><span class="token parameter">oldVnode<span class="token punctuation">,</span> newVnode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>oldVnode<span class="token punctuation">,</span> newVnode<span class="token punctuation">)</span>
    <span class="token comment">// 如果老节点的类型和新节点类型不一样直接替换全局</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>oldVnode<span class="token punctuation">.</span>type<span class="token operator">!==</span>newVnode<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> oldVnode<span class="token punctuation">.</span>domElement<span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span><span class="token function">replaceChild</span><span class="token punctuation">(</span><span class="token function">createDomElementFrom</span><span class="token punctuation">(</span>newVnode<span class="token punctuation">)</span><span class="token punctuation">,</span> oldVnode<span class="token punctuation">.</span>domElement<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language- extra-class"><pre><code>2.类型相同，文本不同，我们只需要把文本修改即可
</code></pre></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// vdom/patch.js</span>
<span class="token operator">...</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">patch</span><span class="token punctuation">(</span><span class="token parameter">oldVnode<span class="token punctuation">,</span> newVnode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>oldVnode<span class="token punctuation">,</span> newVnode<span class="token punctuation">)</span>
 <span class="token comment">// 如果老节点的类型和新节点类型不一样直接替换全局</span>
 <span class="token keyword">if</span><span class="token punctuation">(</span>oldVnode<span class="token punctuation">.</span>type<span class="token operator">!==</span>newVnode<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">return</span> oldVnode<span class="token punctuation">.</span>domElement<span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span><span class="token function">replaceChild</span><span class="token punctuation">(</span><span class="token function">createDomElementFrom</span><span class="token punctuation">(</span>newVnode<span class="token punctuation">)</span><span class="token punctuation">,</span> oldVnode<span class="token punctuation">.</span>domElement<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
 <span class="token comment">// 类型相同，文本不同</span>
 <span class="token keyword">if</span><span class="token punctuation">(</span>oldVnode<span class="token punctuation">.</span>text<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">return</span> oldVnode<span class="token punctuation">.</span>domElement<span class="token punctuation">.</span>textContent <span class="token operator">=</span> newVnode<span class="token punctuation">.</span>text
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><div class="language- extra-class"><pre><code>3.类型一样并且是标签，需要根据新节点的属性，更新老节点的属性,我们不需要创建新的dom了，只需要在原有的dom上更改即可
</code></pre></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">patch</span><span class="token punctuation">(</span><span class="token parameter">oldVnode<span class="token punctuation">,</span> newVnode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token comment">// 类型一样并且是标签，需要根据新节点的属性，更新老节点的属性</span>
    <span class="token keyword">let</span> domElement <span class="token operator">=</span> newVnode<span class="token punctuation">.</span>domElement <span class="token operator">=</span> oldVnode<span class="token punctuation">.</span>domElement

    <span class="token function">updateProperties</span><span class="token punctuation">(</span>newVnode<span class="token punctuation">,</span>oldVnode<span class="token punctuation">.</span>props<span class="token punctuation">)</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language- extra-class"><pre><code>4.类型一样，子节点有更新
(1).老的有节点，新的有节点
(2).老的有节点，新的有没节点
(3).老的没节点，新的有节点
</code></pre></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">patch</span><span class="token punctuation">(</span><span class="token parameter">oldVnode<span class="token punctuation">,</span> newVnode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>oldChildren<span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> newchildren<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 真正的diff </span>
        <span class="token comment">// 常见的dom操作进行优化</span>
        <span class="token comment">// 1.前后追加</span>
        <span class="token comment">// 2.正序倒序</span>
        <span class="token function">updateChildren</span><span class="token punctuation">(</span>domElement<span class="token punctuation">,</span>oldChildren<span class="token punctuation">,</span>newchildren<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>oldChildren<span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>newchildren<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        domElement<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">''</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>oldChildren<span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> newchildren<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>newchildren<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            domElement<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span><span class="token function">createDomElementFrom</span><span class="token punctuation">(</span>newchildren<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 在头尾创建两个指针</span>
<span class="token keyword">function</span> <span class="token function">updateChildren</span><span class="token punctuation">(</span><span class="token parameter">parent<span class="token punctuation">,</span>oldChildren<span class="token punctuation">,</span>newChildren</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> oldStartIndex <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">let</span> oldStartVnode <span class="token operator">=</span> oldChildren<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token keyword">let</span> oldEndIndex <span class="token operator">=</span> oldChildren<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span>
    <span class="token keyword">let</span> oldEndNode <span class="token operator">=</span> oldChildren<span class="token punctuation">[</span>oldEndIndex<span class="token punctuation">]</span>
    <span class="token keyword">let</span> newStartIndex <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">let</span> newStartVnode <span class="token operator">=</span> newChildren<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token keyword">let</span> newEndIndex <span class="token operator">=</span> newChildren<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span>
    <span class="token keyword">let</span> newEndNode <span class="token operator">=</span> newChildren<span class="token punctuation">[</span>newEndIndex<span class="token punctuation">]</span>
    <span class="token comment">// 前追加</span>
    <span class="token comment">// 找到相同的</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>oldStartIndex<span class="token operator">&lt;=</span>oldEndIndex <span class="token operator">&amp;&amp;</span> newStartIndex <span class="token operator">&lt;=</span> newEndIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isSameVnode</span><span class="token punctuation">(</span>oldStartVnode<span class="token punctuation">,</span>newStartVnode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">patch</span><span class="token punctuation">(</span>oldStartVnode<span class="token punctuation">,</span>newStartVnode<span class="token punctuation">)</span>
            oldStartVnode <span class="token operator">=</span> oldChildren<span class="token punctuation">[</span><span class="token operator">++</span>oldStartIndex<span class="token punctuation">]</span>
            newStartVnode <span class="token operator">=</span> newChildren<span class="token punctuation">[</span><span class="token operator">++</span>newStartIndex<span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 相同之后的只需要添加就行</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span> newStartIndex<span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>newEndIndex<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> beforeElement <span class="token operator">=</span> newChildren<span class="token punctuation">[</span>newStartIndex<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> newChildren<span class="token punctuation">[</span>newStartIndex<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>domElement
        parent<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span><span class="token function">createDomElementFrom</span><span class="token punctuation">(</span>newChildren<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>beforeElement<span class="token punctuation">)</span>
        <span class="token comment">// parent.appendChild()</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><ul><li>5.虚拟dom的优势？</li> <li>6.vue中的key有什么作用？
给每个节点做唯一标识，当我们更新patch包时可以通过key找到dom节点，然后修改patch中的需要修改的地方</li> <li>7.vue中diff算法的实现？</li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com//edit/master/docs/note/vue/源码.md" target="_blank" rel="noopener noreferrer">在 Github 上编辑此页</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">更新时间:</span> <span class="time">9/23/2020, 11:12:55 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/note/note/webpack/基本使用.html" class="prev">
        webpack基本使用
      </a></span> <span class="next"><a href="/note/note/vue/nuxt.html">
        nuxt初探
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/note/assets/js/app.fb566414.js" defer></script><script src="/note/assets/js/2.ef60ecc2.js" defer></script><script src="/note/assets/js/58.ca2d3c5a.js" defer></script>
  </body>
</html>
